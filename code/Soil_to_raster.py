# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# Soil to raster.py
# Created on: 2023-04-13 12:15:20.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: Soil to raster <GIS_Modell_Excel_table> <Snap_to_raster> <Jordartskartan> <Output_Geodatabase> 
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy

# Script arguments
GIS_Modell_Excel_table = arcpy.GetParameterAsText(0)
if GIS_Modell_Excel_table == '#' or not GIS_Modell_Excel_table:
    GIS_Modell_Excel_table = "\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$" # provide a default value if unspecified

Snap_to_raster = arcpy.GetParameterAsText(1)
if Snap_to_raster == '#' or not Snap_to_raster:
    Snap_to_raster = "52" # provide a default value if unspecified

Jordartskartan = arcpy.GetParameterAsText(2)

Output_Geodatabase = arcpy.GetParameterAsText(3)

# Local variables:
Jordartskartan___in_memory_copy = "in_memory\\Jordartskartan_TEMP"
Assigning_numbers = Jordartskartan___in_memory_copy
Soil_table = GIS_Modell_Excel_table
in_memory = "in_memory"
Calculating_leakage = Soil_table
A_soil = "in_memory\\A_soil"
A_soil__2_ = A_soil
A_leakage = "in_memory\\A_leakage"
A_leakage__2_ = A_leakage
Derived_Geodatabase = Output_Geodatabase

# Set Geoprocessing environments
arcpy.env.scratchWorkspace = "in_memory"
arcpy.env.snapRaster = Snap to raster
arcpy.env.workspace = "in_memory"

# Process: Copy Features
arcpy.CopyFeatures_management(Jordartskartan, Jordartskartan___in_memory_copy, "", "0", "0", "0")

# Process: Table to Table
arcpy.TableToTable_conversion(GIS_Modell_Excel_table, in_memory, "Soil_table_TEMP", "", "Land_use_7_classes_numbers \"Land_use_7_classes_numbers\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Land_use_7_classes_numbers,-1,-1;M_roughness \"M_roughness\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,M_roughness,-1,-1;Land_use_7_classes_text \"Land_use_7_classes_text\" true true false 255 Text 0 0 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Land_use_7_classes_text,-1,-1;Land_use_7_classes_simplified \"Land_use_7_classes_simplified\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Land_use_7_classes_simplified,-1,-1;Land_use_3_classes \"Land_use_3_classes\" true true false 255 Text 0 0 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Land_use_3_classes,-1,-1;Infiltration \"Infiltration\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Infiltration,-1,-1;Soil_categories_text \"Soil_categories_text\" true true false 255 Text 0 0 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Soil_categories_text,-1,-1;Soil_categories_silmplified \"Soil_categories_silmplified\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Soil_categories_silmplified,-1,-1;Soil_simple \"Soil_simple\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Soil_simple,-1,-1;Leakage \"Leakage\" true true false 8 Double 6 15 ,First,#,\\\\dcema200nas02\\sesth1_DepAdm\\5916\\50_Bibliotek\\54_Teknik och metoder\\Hydraulisk modellering\\GIS-modell\\Automation\\Land_use_soil_values.xlsx\\Latest$,Leakage,-1,-1", "")

# Process: Join Field - soil categories to numbers
arcpy.JoinField_management(Jordartskartan___in_memory_copy, "JBAS_TX", Soil_table, "Soil_categories_text", "Soil_categories_silmplified")

# Process: Join Field - Leakage
arcpy.JoinField_management(Assigning_numbers, "Soil_categories_silmplified", Soil_table, "Soil_simple", "Leakage")

# Process: Polygon to Raster
arcpy.PolygonToRaster_conversion(Calculating_leakage, "Soil_categories_silmplified", A_soil, "CELL_CENTER", "NONE", Snap_to_raster)

# Process: Build Pyramids And Statistics
arcpy.BuildPyramidsandStatistics_management(A_soil, "INCLUDE_SUBDIRECTORIES", "BUILD_PYRAMIDS", "CALCULATE_STATISTICS", "NONE", "", "NONE", "1", "1", "", "-1", "NONE", "NEAREST", "DEFAULT", "75", "SKIP_EXISTING", "")

# Process: Polygon to Raster (2)
arcpy.PolygonToRaster_conversion(Calculating_leakage, "Leakage", A_leakage, "CELL_CENTER", "NONE", Snap_to_raster)

# Process: Build Pyramids And Statistics (2)
arcpy.BuildPyramidsandStatistics_management(A_leakage, "INCLUDE_SUBDIRECTORIES", "BUILD_PYRAMIDS", "CALCULATE_STATISTICS", "NONE", "", "NONE", "1", "1", "", "-1", "NONE", "NEAREST", "DEFAULT", "75", "SKIP_EXISTING", "")

# Process: Raster To Geodatabase (multiple)
arcpy.RasterToGeodatabase_conversion("in_memory\\A_soil;in_memory\\A_leakage", Output_Geodatabase, "")

